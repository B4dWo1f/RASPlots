<!DOCTYPE html>
<html>
<head>  <meta charset="utf-8">
   <style>
      .FullMap {width:100%;
                height:auto;
                text-align:center;
                padding:0px;
                position: relative;
                left:0px;
                top:0px;}
      img {max-width:100%;
           height:auto;}
      .L0 {position: relative;
           top: 0;
           left: 0;
           visibility:visible;}
      .L1 {position: absolute;
           top: 0px;
           left: 0px;
           visibility:hidden;}
      .L2 {position: absolute;
           top: 0px;
           left: 0px;
           visibility:visible;
           mix-blend-mode: overlay;
           opacity:0.33;}
      .L3 {position: absolute;
           top: 0px;
           left: 0px;
           visibility:visible;
           opacity:0.75;}
      .plot_title{font-size:150%;}
      .domains{font-size:120%;}
      .days{font-size:120%;}
      .hours{font-size:120%;}
  </style>
</head>

<body>
<table align="center">
   <tr>
      <td align="right"><a href="http://www.denubeanube.com/"><img src="/dnn.svg" alt="De Nube a Nube" width="150" height="81" align="center"></a></td>
      <td align="left">
        <font size="+3"><b>RASP</b> Sistema Central</font><br>
        <a href="http://www.drjack.info/RASP/">RASP</a> by Dr. Jack, local site by <a href="http://raspuri.mooo.com/RASP/index.php">Oriol</a> & Noel
      </td>
   </tr>
</table>


<p class="domains" align='center'>
<a href="javascript:change_domain('w2');">Sistema Central</a> |
<a href="javascript:change_domain('d2');">Península</a>
</p>

<p align='center' id="days" class="days"></p>

<p align='center' id="hours" class="hours"></p>


<hr>
<table>
<tr>
   <td> Vector Layer: </td>
   <td> <input id="SliderOpacity" type="range" min="0" max="100" value="75" oninput="set_opacity(this.value,'vector_layer')"> </td>
</tr>
</table>
<form>
<input type="radio" id="chkSFCwind"  onChange="replot_vector('sfcwind');" name='foo' checked>Viento superficie
<input type="radio" id="chkBLwind"  onChange="replot_vector('blwind');" name='foo'>Viento BL
<input type="radio" id="chkBLTOPwind"  onChange="replot_vector('bltopwind');" name='foo'>Viento BL Top
<input type="radio" id="chkBLTOPwind"  onChange="toggleVisibility('vector_layer');" name='foo'>None
</form>
<hr style="border-color:LightGrey; border-style: dashed; ">
<table>
<tr>
   <td> Scalar Layer: </td>
   <td> <input id="SliderOpacity" type="range" min="0" max="100" value="33" oninput="set_opacity(this.value,'scalar_layer')"> </td>
</tr>
</table>

<form>
<input type="radio" id="chkSFCwind"  onChange="replot_scalar('sfcwind');" name='foo' checked>SFCwind
<input type="radio" id="chkBLwind"  onChange="replot_scalar('blwind');" name='foo'>BLwind
<input type="radio" id="chkBLTOPwind"  onChange="replot_scalar('bltopwind');" name='foo'>BLTopwind
<input type="radio" id="chkCAPE"  onChange="replot_scalar('cape');" name='foo'>CAPE
<input type="radio" id="chkHBL"  onChange="replot_scalar('hbl');" name='foo'> Height BL
<input type="radio" id="chkWstar"  onChange="replot_scalar('wstar');" name='foo'> Thermals
<input type="radio" id="chkBSratio"  onChange="replot_scalar('bsratio');" name='foo'> B/S Ratio
<input type="radio" id="chkClouds"  onChange="replot_scalar('cloud');" name='foo'> Clouds 
<hr>
</form>



<p align="center">
<table>
   <tr>
      <td align="left" style="min-width:120px">
      </td>
      <td align="center">
         <div class="plot_title" align='center' id="Title"></div>
      </td>
   </tr>
   <tr>
      <td align="left">
         <form>
         <input type="checkbox" id="chkCCAA" onChange="toggleVisibility('ccaa_layer');" checked>Provincias<br>
         <input type="checkbox" id="chkRivers"  onChange="toggleVisibility('rivers_layer');" >Ríos y lagos<br>
         <input type="checkbox" id="chkRoads"  onChange="toggleVisibility('roads_layer');" >Carreteras<br>
         <input type="checkbox" id="chkRoads"  onChange="toggleVisibility('takeoffs_layer');" checked>Despegues<br>
         </form>
      <td align="left">
         <div class="FullMap">
            <!-- Terrain -->
            <img class="L0" id="terrain_layer" style="visibility:visible">
            <img class="L1" id="ccaa_layer" style="visibility:visible">
            <!-- Meteo -->
            <img class="L1" id="rivers_layer" style="visibility:hidden">
            <img class="L1" id="roads_layer" style="visibility:hidden">
            <img class="L1" id="takeoffs_layer" style="visibility:visible">
            <img class="L2" id="scalar_layer">
            <img class="L3" id="vector_layer" style="visibility:visible">
      </div>
      </td>
   </tr>
</table>
</p>

</body>


<script>
   var title_prop = {'blwind':'BL Wind', 'bltopwind':'BL Top Wind', 'sfcwind':'Surface Wind',
                     'cape': 'CAPE', 'wstar':'Thermal Updraft Velocity', 'hbl':'Height of BL Top',
                     'bsratio':'Buoyancy/Shear Ratio', 'blcloudpct': '1h Accumulated Rain',
                     'mslpress':'Mean Sea Level Pressure'}
   var days = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
   var months = ['January','February','March','April','May','June','July','August','September','October','November','December'];
   var SCs = ['SC2', 'SC2+1', 'SC4+2', 'SC4+3']

   var today = new Date()
   var d = today.getDate();
   var dw = days[ today.getDay() ];
   var m = today.getMonth() + 1;
   var my = months[ today.getMonth() ];
   var y = today.getFullYear();
   //var folder = '/var/www/html/RASP/data/PLOTS';
   var folder = 'data/PLOTS';

   /* Global variables */
   var sc = 'SC2';
   var domain = 'w2';
   var Sprop = 'sfcwind';
   var Vprop = 'sfcwind';
   var hour = '12';

   var plot_title = document.getElementById("Title");

   // Default values for initial load
   document.getElementById('terrain_layer').src = folder+'/'+domain+'/'+sc+'/terrain.png';
   document.getElementById('ccaa_layer').src = folder+'/'+domain+'/'+sc+'/ccaa.png';
   document.getElementById('rivers_layer').src = folder+'/'+domain+'/'+sc+'/rivers.png';
   document.getElementById('roads_layer').src = folder+'/'+domain+'/'+sc+'/roads.png';
   document.getElementById('takeoffs_layer').src = folder+'/'+domain+'/'+sc+'/takeoffs.png';
   // meteo
   document.getElementById('scalar_layer').src =  folder+'/'+domain+'/'+sc+'/'+hour+'00_'+Sprop+'.png';
   document.getElementById('vector_layer').src =  folder+'/'+domain+'/'+sc+'/'+hour+'00_'+Vprop+'_vec.png';
   plot_title.innerHTML = dw+' '+d+' '+title_prop[Sprop]+' '+hour+':00';

   // Generate days
   var text = "| ";
   var i;
   for (i = 0; i <= 3; i++) {
      text += '<a href="javascript:change_day(' + i.toString() + ');">' 
      text += days[(( today.getDay() + i )%7)] + "</a> |";
   }
   document.getElementById("days").innerHTML = text;

   // Generate hours
   var text = "| ";
   var i;
   for (i = 8; i <= 20; i++) {
      text += '<a href="javascript:change_hour('+i.toString()+');">' + i.toString() + ":00 </a>| ";
   }
   document.getElementById("hours").innerHTML = text;


   function replot_vector(x){
      Vprop = x
      var VL = document.getElementById('vector_layer')
      VL.src= folder+'/'+domain+'/'+sc+'/'+hour+'00_'+Vprop+'_vec.png'; //sc+'_'+Vprop+'_vec.png';
      if (VL.style.visibility=="hidden") {
         VL.style.visibility="visible";}
      //plot_title.innerHTML = folder+'/'+domain+'/'+sc+'/'+hour+'00_'+Vprop+'_vec.png';
   }
   function replot_scalar(x){
      Sprop = x
      document.getElementById('scalar_layer').src= folder+'/'+domain+'/'+sc+'/'+hour+'00_'+Sprop+'.png'; //sc+'_'+Sprop+'.png';
      plot_title.innerHTML = dw+' '+d+' '+title_prop[Sprop]+' '+hour+':00';
   }
   function change_hour(x) {
      hour = x;
      replot_scalar(Sprop);
      replot_vector(Vprop);
      plot_title.innerHTML = dw+' '+d+' '+title_prop[Sprop]+' '+hour+':00';
   }
   function change_domain(x) {
      domain = x
      replot_scalar(Sprop);
      replot_vector(Vprop);
      document.getElementById('terrain_layer').src = folder+'/'+domain+'/'+sc+'/terrain.png';
      document.getElementById('ccaa_layer').src = folder+'/'+domain+'/'+sc+'/ccaa.png';
      document.getElementById('rivers_layer').src = folder+'/'+domain+'/'+sc+'/rivers.png';
      document.getElementById('roads_layer').src = folder+'/'+domain+'/'+sc+'/roads.png';
      document.getElementById('takeoffs_layer').src = folder+'/'+domain+'/'+sc+'/takeoffs.png';
   }
   function change_day(x) {
      sc = SCs[x];
      dw = days[(( today.getDay() + x )%7)];
      var newDate = new Date(Date.now() + x*24*60*60*1000);
      d = newDate.getDate();
      replot_scalar(Sprop);
      replot_vector(Vprop);
      document.getElementById('terrain_layer').src = folder+'/'+domain+'/'+sc+'/terrain.png';
      document.getElementById('ccaa_layer').src = folder+'/'+domain+'/'+sc+'/ccaa.png';
      document.getElementById('rivers_layer').src = folder+'/'+domain+'/'+sc+'/rivers.png';
      document.getElementById('roads_layer').src = folder+'/'+domain+'/'+sc+'/roads.png';
      document.getElementById('takeoffs_layer').src = folder+'/'+domain+'/'+sc+'/takeoffs.png';
      plot_title.innerHTML = dw+' '+d+' '+title_prop[Sprop]+' '+hour+':00';
   }
   function select_vector_layer(id) {
      prop_vec = id;
   }
   function toggleVisibility(id) {
     var el = document.getElementById(id);
     if (el.style.visibility=="visible") {
        el.style.visibility="hidden";}
     else {
        el.style.visibility="visible";}
   }
   // ------------ Slider ------------
   function set_opacity(x,layer) {
      document.getElementById(layer).style.opacity = x/100;
      replot_scalar(Sprop);
   }
</script>
</html>
